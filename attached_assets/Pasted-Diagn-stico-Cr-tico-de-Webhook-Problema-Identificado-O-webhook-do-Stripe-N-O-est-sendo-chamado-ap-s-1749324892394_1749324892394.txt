Diagn칩stico Cr칤tico de Webhook
Problema Identificado
O webhook do Stripe N츾O est치 sendo chamado ap칩s o pagamento. O storeId est치 correto, mas n칚o h치 logs do webhook no console do servidor, indicando que os eventos do Stripe n칚o est칚o chegando.
Diagn칩stico Necess치rio
1. Verificar se o Webhook Existe e Est치 Ativo
Por favor, verifique se existe um arquivo de webhook no projeto:

server/controllers/webhook.controller.ts
server/controllers/stripe-webhook.controller.ts
Ou similar

2. Verificar Rota do Webhook
Verifique se existe uma rota configurada para o webhook, algo como:
typescript// No arquivo de rotas (app.ts, index.ts, ou routes/)
app.post('/api/stripe/webhook', webhookController);
// ou
app.post('/webhook/stripe', webhookController);
3. Verificar Configura칞칚o no Painel do Stripe
Se o webhook existe no c칩digo, o problema pode estar na configura칞칚o do Stripe:
Passos para verificar no Stripe Dashboard:

Acesse o painel do Stripe (dashboard.stripe.com)
V치 em "Developers" > "Webhooks"
Verifique se existe um webhook configurado
A URL deve apontar para: https://seu-replit-url.replit.dev/api/stripe/webhook
Verifique se os eventos est칚o configurados:

checkout.session.completed
invoice.payment_succeeded
customer.subscription.updated
customer.subscription.deleted



4. Teste de Conectividade do Webhook
Se o webhook existe, adicione um log b치sico no in칤cio da fun칞칚o:
typescriptexport async function handleStripeWebhook(req: Request, res: Response) {
  console.log('游뚿 WEBHOOK CHAMADO! 游뚿');
  console.log('Headers:', req.headers);
  console.log('Body type:', typeof req.body);
  
  // resto do c칩digo...
}
5. Verificar Middleware de Body Parser
O webhook precisa de configura칞칚o especial para receber dados do Stripe:
typescript// Deve ter algo assim no app.ts ou index.ts
app.use('/api/stripe/webhook', express.raw({ type: 'application/json' }));
Poss칤veis Cen치rios:
Cen치rio A: Webhook n칚o existe no c칩digo

Solu칞칚o: Criar o webhook controller
Prioridade: Alta

Cen치rio B: Webhook existe mas rota n칚o configurada

Solu칞칚o: Adicionar rota no arquivo principal
Prioridade: Alta

Cen치rio C: Webhook configurado mas URL errada no Stripe

Solu칞칚o: Corrigir URL no painel do Stripe
Prioridade: M칠dia

Cen치rio D: Webhook configurado mas eventos n칚o selecionados

Solu칞칚o: Adicionar eventos necess치rios no Stripe
Prioridade: M칠dia

A칞칚o Imediata Solicitada:

Verificar se existe arquivo de webhook
Verificar se rota est치 configurada
Adicionar log b치sico no webhook (se existir)
Fazer novo teste de pagamento
Reportar se aparecem logs do webhook

Resultado Esperado:
Ap칩s as verifica칞칫es, deveremos ver logs como:
游뚿 WEBHOOK CHAMADO! 游뚿
Event type: checkout.session.completed
Session ID: cs_test_...
Se n칚o aparecerem logs, o problema 칠 de configura칞칚o de webhook.
Se aparecerem logs, o problema 칠 na l칩gica de processamento.
Por favor, execute estes diagn칩sticos e reporte os resultados para identificarmos a causa raiz.